---
title: "Song distinguishability regressions"
author: "Nicole Creanza"
date: "2024-02-23"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}

library(ggplot2)
```

```{r}
# Read in datasets

Genetic_Geographic_MLaccuracy <- read.table("/Users/sarahhourihan/Library/CloudStorage/Box-Box/Creanza Lab/Sarah_Nicole/files_for_manuscript/PUBLISH_Genetic_Geographic_MLsongaccuracy.txt",sep="\t",header=T)

#Plot geographic and genetic distance vs song classifier accuracy for 15 subspecies pairs

ggplot(Genetic_Geographic_MLaccuracy, aes(x = Median.geographic.distance..km., y = Balanced.accuracy.of.song.classifier)) +
  geom_point() +
  theme_minimal() +
  geom_smooth(method = "lm", se = TRUE, aes(group = 1)) +
  labs(x = "Median geographic distance (km)",
       y = "Random forest classifier accuracy") +
  ylim(0, 1)


ggplot(Genetic_Geographic_MLaccuracy, aes(x = Average.genetic.distance, y = Balanced.accuracy.of.song.classifier)) +
  geom_point() +
  theme_minimal() +
  geom_smooth(method = "lm", se = TRUE, aes(group = 1)) +
  labs(x = "Average genetic distance",
       y = "Random forest classifier accuracy") +
  ylim(0, 1)


ggplot(Genetic_Geographic_MLaccuracy, aes(x = Pairwise.Fst, y = Balanced.accuracy.of.song.classifier)) +
  geom_point() +
  theme_minimal() +
  geom_smooth(method = "lm", se = TRUE, aes(group = 1)) +
  labs(x = "Average Pairwise Fst",
       y = "Random forest classifier accuracy") +
  ylim(0, 1)


#linear regressions of geographic and genetic distance vs song classifier accuracy 

summary(lm(Balanced.accuracy.of.song.classifier~Median.geographic.distance..km.,data=Genetic_Geographic_MLaccuracy))
summary(lm(Balanced.accuracy.of.song.classifier~Average.genetic.distance,data=Genetic_Geographic_MLaccuracy))
summary(lm(Balanced.accuracy.of.song.classifier~Pairwise.Fst,data=Genetic_Geographic_MLaccuracy))


# Resample the balanced accuracy values 100000 times to see if it is surprising that the mean of 3 values is 0.84
ResampleMLaccuracy <- Genetic_Geographic_MLaccuracy$Balanced.accuracy.of.song.classifier
n_resamples <- 100000
set.seed(51)  
resampled_means <- replicate(n_resamples, mean(sample(ResampleMLaccuracy, 3, replace = FALSE))) #resample without replacement 100000 times

# Plot a histogram of the resampled means
hist(resampled_means, breaks = 20)
AdjNonHybMeanValue <- 0.84
percent_greater <- sum(resampled_means > AdjNonHybMeanValue)/n_resamples
print(paste("Percent of resampled means greater than", AdjNonHybMeanValue, ":", percent_greater)) #0.065

